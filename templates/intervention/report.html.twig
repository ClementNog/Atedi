{% extends 'base.html.twig' %}

{% block title %}Rapport d'intervention{% endblock %}

{% block javascripts %}        
    <script src="{{ asset('assets/js/colorFinder.js') }}"></script>
    <script src="{{ asset('assets/js/menuExpend.js') }}"></script>
{% endblock %}

{% block body %}
    <a href="{{ path('intervention_show', {'id': intervention.id}) }}"><i class="fas fa-chevron-left h1 float-left"></i></a>
    <h1 class='text-center mb-5'>Rapport d'intervention</h1>

    <div class="container show-container">
        <div class="row justify-content-around mb-5">
            <div class="container-background col-md-auto mb-auto p-4">
                <div class='row'>
                    <div class='col text-center'>
                        <a class="w-100 p-2 more-infos f-20" data-toggle="collapse" href="#moreInfosClient" aria-expanded="false">Rappel des informations client<i class="ml-2 fas fa-chevron-down more-infos-chevron"></i></a>
                        <hr>
                    </div>
                </div>
                <div class="collapse" id="moreInfosClient">
                    <div class='row mb-2'>
                        <div class='col-md-auto my-auto'><i class="fas fa-user"></i></div>
                        <div class='col'>{{ intervention.client.lastName }} {{ intervention.client.firstName }}</div>
                    </div>
                    <hr>
                    <div class='row mb-2'>
                        <div class='col-md-auto my-auto'><i class="fas fa-phone"></i></div>
                        <div class='col'>{{ intervention.client.phone }}</div>
                    </div>
                    <hr>
                    <div class='row mb-2'>
                        <div class='col-md-auto my-auto'><i class="fas fa-at"></i></div>
                        <div class='col'>{{ intervention.client.email ?: "<div class='missing-info'>Email non-renseignée</div>" }}</div>
                    </div>
                    <hr>
                    <div class='row'>
                        <div class='col-md-auto my-auto'><i class="fas fa-map-marker-alt"></i></div>
                        <div class='col'>
                            <div class="d-flex flex-column">
                                {% if (intervention.client.street) or (intervention.client.city) or (intervention.client.postalCode) %}
                                    {% if intervention.client.street %}
                                        <div>{{ intervention.client.street }}</div>
                                    {% endif %}
                                    {% if (intervention.client.city) or (intervention.client.postalCode) %}
                                        <div>{{ intervention.client.city }} {{ intervention.client.postalCode }}</div>
                                    {% endif %}
                                {% else %}
                                    <div class='missing-info'>Adresse non-renseignée</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container-background col-md-auto mb-auto p-4">
                <div class='row'>
                    <div class='col text-center'>
                        <a class="w-100 p-2 more-infos f-20" data-toggle="collapse" href="#moreInfosIntervention" aria-expanded="false">Rappel des informations de l'intervention<i class="ml-2 fas fa-chevron-down more-infos-chevron"></i></a>
                        <hr>
                    </div>
                </div>
                <div class="collapse" id="moreInfosIntervention">
                    <div class='row'>
                        <div class='col-md-auto my-auto'><i class="fas fa-comment-dots"></i></div>
                        <div class='col'>
                            <div class='comment p-2'>{{ intervention.comment ?: "<div>Pas de commentaire</div>" }}</div>
                        </div>
                    </div>
                    <hr>
                    <div class='row'>
                        <div class='col-md-auto my-auto'><i class="fas fa-clock"></i></div>
                        <div class='col'>
                            <div class='row'>
                                <div class='col-md-auto'>
                                    <div class="d-flex flex-column text-center">
                                        <div>Date de dépôt</div>
                                        <div>{{ intervention.depositDate ? intervention.depositDate|date('d-m-Y') : "<div class='missing-info'>Non-renseignée</div>" }}</div>
                                    </div>
                                </div>
                                <div class='col-md-auto'>
                                    <div class="d-flex flex-column text-center">
                                        <div>Date de retour</div>
                                        <div>{{ intervention.returnDate ? intervention.returnDate|date('d-m-Y') : "<div class='missing-info'>Non-renseignée</div>" }}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class='row'>
                        <div class='col-md-auto my-auto'><i class="fas fa-users-cog"></i></div>
                        <div class='col'>
                            <div>
                                {% for technician in intervention.technicians %}
                                    {{ technician }}{% if not loop.last %}, {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class='row mb-2'>
                        <div class='col-md-auto ml-1 my-auto'><div class="color-box" data-color="#{% for task in intervention.tasks %}{{ task.color }}{% endfor %}"></div></div>
                        <div class='col'>
                            <div>
                                {% for task in intervention.tasks %}
                                    {{ task }}{% if not loop.last %}, {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class='row mb-2'>
                        <div class='col-md-auto my-auto'><i class="fas fa-desktop"></i></div>
                        <div class='col'>
                            <div class="d-flex flex-column">
                                <div>{{ intervention.equipment }}</div>
                                <div>{{ intervention.operatingSystem }}</div>
                                <div>Matériel complet : {{ intervention.equipmentComplete }}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <div class="row justify-content-around mb-3 report-container">
            <div class='f-20 w-100'>Logiciels de netoyage utilisés</div>
            <div class="container-background col px-4 py-2 content">
                {% for software in softwares %}
                    <div class='f-20 w-100'>{{ software.title }}</div>
                {% endfor %}
            </div>
        </div>

        <div class="row justify-content-around mb-3 report-container">
            <div class='f-20 w-100'>Opérations effectuées</div>
            <div class="container-background col p-4"></div>
        </div>

        <div class="row justify-content-around mb-3 report-container">
            <div class='f-20 w-100'>Sous-partie Windows</div>
            <div class="container-background col p-4"></div>
        </div>

        <div class="row justify-content-around mb-3 report-container">
            <div class='f-20 w-100'>Observation</div>
            <div class="container-background col p-4"></div>
        </div>

    </div>
{% endblock %}
